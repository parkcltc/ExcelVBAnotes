Option Explicit

Sub ReplaceFormula()

Dim Years As String: Dim Defect As Long: Dim Rework As Long: Dim Total As Long: Dim CurrMonths As String: Dim PrevMonths As String
Dim FormulaString As String
Dim PrevStr As String
Dim CurrStr As String
Dim SheetName1 As String: Dim SheetName2 As String

Sheets(1).Activate
SheetName1 = Sheets(1).Name
Years = Range("D2").Value
FormulaString = ActiveCell.Offset(0, -1).Formula
CurrMonths = ActiveCell.Offset(-1, 0)
PrevMonths = ActiveCell.Offset(-1, -1)
If (PrevMonths = "Jul") Then

PrevMonths = "7." & PrevMonths & "''" & Right(Years, 2)
Range("E2").Value = PrevMonths
CurrMonths = "8." & CurrMonths & "''" & Right(Years, 2)
Range("F2").Value = CurrMonths
End If

FormulaString = Replace(FormulaString, PrevMonths, CurrMonths)
FormulaString = Replace(FormulaString, "$", "")
ActiveCell.Formula = Replace(FormulaString, "Jul", "Aug")


Range("D5").AutoFill Destination:=Range("D5:D9")

Dim saveLocation As String
saveLocation = "C:\Users\HP\Desktop\Excel Project\" & SheetName1 & ".pdf"

Sheets(1).ExportAsFixedFormat Type:=xlTypePDF, _
    Filename:=saveLocation











End Sub

